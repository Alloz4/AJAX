<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>

    <form>
        <label for='comunidad'>Comunidad autónoma: </label>
        <select id='comunidad'>
            <option value='' selected='selected'>--Elija una comunidad--</option>
            <option>andalucia</option>
            <option>aragon</option>
            <option>asturias</option>
            <option>baleares</option>
            <option>canarias</option>
            <option>cantabria</option>
            <option>castilla la mancha</option>
            <option>castilla y leon</option>
            <option>cataluña</option>
            <option>comunidad Valenciana</option>
            <option>extremadura</option>
            <option>galicia</option>
            <option>la rioja</option>
            <option>madrid</option>
            <option>navarra</option>
            <option>pais vasco</option>
            <option>murcia</option>
            <option>ceuta</option>
            <option>melilla</option>
        </select>
        <br>
        <label for='provincias'>Provincias: </label>

    </form>
    <script>

        // A partir del archivo “ccaa.json” proporcionado y el archivo “provincias.html”, desarrolla el código en cabecera y en javascript vanilla que permita:
        // Controlar la carga del documento html por medio del oyente de evento “DOMContentLoaded”.
        // Definir las variables que referencien cada uno de los objetos del archivo html.
        // Definir el oyente de evento necesario para que al cambiar la elección en la ccaa se inicie 
        //el proceso necesario para solicitar al servidor “ccaa.json” las provincias que componen la ccaa solicitada y 
        //recoger la respuesta del servidor en el formato adecuado y presentarla en el componente creado dinámicamente, el select identificado como provincias.

        let provincias = document.querySelector('select');

        document.addEventListener('DOMContentLoaded', function () {

            let comunidades = document.querySelector('#comunidad');

            comunidades.addEventListener('change', function () {
                let comunidad = comunidades.value;
                let url = 'ccaa.json';
                let peticion = new XMLHttpRequest();
                peticion.open('GET', url);
                peticion.send();
                peticion.addEventListener('readystatechange', function () {
                    if (peticion.readyState == 4 && peticion.status == 200) {
                        let datos = JSON.parse(peticion.responseText);
                        let provincias = datos[comunidad];
                        let select = document.createElement('select');
                        select.setAttribute('id', 'provincias');
                        for (let i = 0; i < provincias.length; i++) {
                            let option = document.createElement('option');
                            option.setAttribute('value', provincias[i]);
                            option.innerHTML = provincias[i];
                            select.appendChild(option);
                        }
                        document.querySelector('form').appendChild(select);
                    }
                });

                let select = document.querySelector('#provincias');
                select.parentNode.removeChild(select);
            });
        });













    </script>
</body>

</html>