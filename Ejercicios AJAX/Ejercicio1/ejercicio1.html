<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Datos JSON obtenidos a partir de PHP</title>
</head>

<body>
    <h1>Datos para enviar a PHP</h1>

    <input type="text" id="nombre" placeholder="Nombre" accept="text/plain"><br><br>
    <input type="text" id="apellido" placeholder="Apellido" accept="text/plain"><br><br>
    <input type="number" id="edad" placeholder="Edad" accept="text/plain">

    <div class="enviar">
        <h3>Enviar</h3>
    </div>
    <hr>
    <div class="respuesta"></div>

    <script>

        //CON FUNCIONES SIN ENCADENAR

        // var nombre = document.getElementById("nombre");
        // var apellido = document.getElementById("apellido");
        // var edad = document.getElementById("edad");

        // document.addEventListener("DOMContentLoaded", iniciar);

        // function iniciar() {
        //     var enviar = document.querySelector(".enviar");
        //     enviar.addEventListener("click", enviarDatos);
        // }

        // function enviarDatos() {
        //     var xhr = new XMLHttpRequest();
        //     xhr.open("POST", "datos.php", true);
        //     xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
        //     xhr.onreadystatechange = function () {
        //         if (xhr.readyState == 4 && xhr.status == 200) {
        //             var respuesta = document.querySelector(".respuesta");
        //             respuesta.innerHTML = xhr.responseText;
        //         }
        //     }
        //     xhr.send("nombre=" + nombre.value + "&apellido=" + apellido.value + "&edad=" + edad.value);
        // }


        //CON FUNCIONES ENCADENADAS

        document.addEventListener("DOMContentLoaded", function () {
            let nombre = document.querySelector('nth-child(1)');
            console.log(nombre);
            let apellido = document.getElementById("apellido");
            let edad = document.getElementById("edad");
            let enviar = document.querySelector(".enviar");
            let respuesta = document.querySelector(".respuesta");


            enviar.addEventListener("click", function () {


                let datos = {
                    nombre: nombre.value,
                    apellido: apellido.value,
                    edad: edad.value
                }


                let xhr = new XMLHttpRequest();

                const params = `nombre=${datos.nombre}&apellido=${datos.apellido}&edad=${datos.edad}`;
                xhr.open("POST", "datos.php", true);
                xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
                xhr.onreadystatechange = function () {
                    if (xhr.readyState == 4 && xhr.status == 200) {
                        respuesta.innerHTML = xhr.responseText;
                    }
                }

                xhr.send(params);

            })

        })


    </script>
</body>

</html>